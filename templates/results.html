<!DOCTYPE html>
<html>
<head>

	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab:300' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/results.css') }}">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script src="{{ url_for('static', filename='js/chart.js') }}"></script>
	<script src="{{ url_for('static', filename='js/script.js') }}"></script>
	<script>
	gbOqtApp.controller("ResultsCtrl", ["$scope", "$http", function($scope, $http) {
		$scope.shareOnFacebook = function() {
			console.log("shareOnFacebook is being called.");
			window.open("https://facebook.com/sharer/sharer.php?u=http://worldnewsquiz-dev.mediameter.org/?pc={{ pct_correct }}", 'Share on Facebook', 'width=672,height=555');
		}

		$scope.shareOnTwitter = function() {
			console.log("shareOnTwitter is being called.");
			window.open("https://twitter.com/intent/tweet?text=I%20scored%20{{ pct_correct }}%25!%20Test%20your%20World%20News%20knowledge%20with%20this%20quiz%20developed%20at%20MIT!&url=http%3A%2F%2Fworldnewsquiz-dev.mediameter.org&hashtags=WorldNewsQuiz", "Share on Twitter", 'width=534,height=424');
		}
	}]);
	</script>
	<title>{{ strings_d["World News Quiz"][lang] }} | {{ strings_d["Your Results!"][lang] }}</title>
</head>

<body>
	{% if not in_china %}
	<script>
	$(window).load(function() {
	window.fbAsyncInit = function() {
		FB.init({
			appId	: '1459853577646905',
			xfbml	: true,
			version	: 'v2.3',
			status	: false,
		});

		!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');

		var ctx = $("#bar")[0].getContext("2d");
		var options = {
			/*scaleOverride: true,
			scaleStartValue: 0,*/
			// animation: false,
			scaleShowGridLines: false,
			scaleShowLabels: false,
		};
		var data = {
	    	labels: ["0-9%", "10-19%", "20-29%", "30-39%", "40-49%", "50-59%", "60-69%", "70-79%", "80-89%", "90-100%"],
	    	datasets: [
		        {
		            // fillColor: "rgba(146,69,171,0.5)",
		            // strokeColor: "rgba(146,69,171,0.8)",
		            // highlightFill: "rgba(146,69,171,0.75)",
		            // highlightStroke: "rgba(146,69,171,1)",
		            fillColor: "rgba(128,128,128,0.5)",
		            strokeColor: "rgba(128,128,128,128)",
		            highlightFill: "rgba(128,128,128,0.75)",
		            highlightStroke: "rgba(128,128,128,1)",
		            data: [{{ histogram_d["0s"] }},
		            	   {{ histogram_d["10s"] }},
		            	   {{ histogram_d["20s"] }},
		            	   {{ histogram_d["30s"] }},
		            	   {{ histogram_d["40s"] }},
		            	   {{ histogram_d["50s"] }},
		            	   {{ histogram_d["60s"] }},
		            	   {{ histogram_d["70s"] }},
		            	   {{ histogram_d["80s"] }},
		            	   {{ histogram_d["90s"] }}],
		        },
	    	],
		};
		var percentileChart = new Chart(ctx).Bar(data, options);
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].fillColor = "rgba(146,69,171,0.5)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].strokeColor = "rgba(146,69,171,0.8)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].highlightFill = "rgba(146,69,171,0.75)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].highlightStroke = "rgba(146,69,171,1)";
		percentileChart.update();
	};

	(function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         {% if lang == "en" %}
         js.src = "//connect.facebook.net/en_US/sdk.js";
         {% else %}
         js.src = "//connect.facebook.net/zh_CN/sdk.js";
         {% endif %}
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
	});
	</script>
	{% else %}
	<script>
	$(window).load(function() {
		var ctx = $("#bar")[0].getContext("2d");
		var options = {
			/*scaleOverride: true,
			scaleStartValue: 0,*/
			// animation: false,
			scaleShowGridLines: false,
			scaleShowLabels: false,
		};
		var data = {
	    	labels: ["0-9%", "10-19%", "20-29%", "30-39%", "40-49%", "50-59%", "60-69%", "70-79%", "80-89%", "90-100%"],
	    	datasets: [
		        {
		            // fillColor: "rgba(146,69,171,0.5)",
		            // strokeColor: "rgba(146,69,171,0.8)",
		            // highlightFill: "rgba(146,69,171,0.75)",
		            // highlightStroke: "rgba(146,69,171,1)",
		            fillColor: "rgba(128,128,128,0.5)",
		            strokeColor: "rgba(128,128,128,128)",
		            highlightFill: "rgba(128,128,128,0.75)",
		            highlightStroke: "rgba(128,128,128,1)",
		            data: [{{ histogram_d["0s"] }},
		            	   {{ histogram_d["10s"] }},
		            	   {{ histogram_d["20s"] }},
		            	   {{ histogram_d["30s"] }},
		            	   {{ histogram_d["40s"] }},
		            	   {{ histogram_d["50s"] }},
		            	   {{ histogram_d["60s"] }},
		            	   {{ histogram_d["70s"] }},
		            	   {{ histogram_d["80s"] }},
		            	   {{ histogram_d["90s"] }}],
		        },
	    	],
		};
		var percentileChart = new Chart(ctx).Bar(data, options);
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].fillColor = "rgba(146,69,171,0.5)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].strokeColor = "rgba(146,69,171,0.8)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].highlightFill = "rgba(146,69,171,0.75)";
		percentileChart.datasets[0].bars[{{ purple_bar_i }}].highlightStroke = "rgba(146,69,171,1)";
		percentileChart.update();
	});
	</script>
	{% endif %}
	<!--<script src="https://apis.google.com/js/platform.js" defer></script>-->

	<div ng-app="gbOqtApp">
	<div id="main_container" class="container-fluid">
	<div id="result_box">
		<div id="percent_and_sentence">
			<div id="percent">
			{{ pct_correct}}%
			</div>
			<div id="result">
			{% if pct_correct >= 90 %}
			Excellent job!
			{% elif pct_correct >= 80 %}
			Good job!
			{% elif pct_correct >= 70 %}
			Not bad!{% endif %}
			{% if lang == "en" %}
			You got <text>{{ num_correct }}</text> of the 22 questions right!
			{% else %}
			在22道问题中，您成功回答了<text>{{ num_correct }}</text>题！
			{% endif %}
			</div>
		</div>
		<div id="percentile">
			<canvas id="bar" class="chart chart-bar" data="data" labels="labels"></canvas>
			<div id="percentile_statement">
			{{ strings_d["How you stack up against other quiz takers."][lang] }}
			</div>
		</div>
		<div id="read_up">
			{% if not in_china %}
			{% if lang == "en" %}
			Try reading up on what's going on in <a href="https://news.google.com/?q={{ code_to_country[readup_countries[0]] }}" target="_blank">{{ code_to_country[readup_countries[0]] }}</a>, <a href="https://news.google.com/?q={{ code_to_country[readup_countries[1]] }}" target="_blank">{{ code_to_country[readup_countries[1]] }}</a>, and <a href="https://news.google.com/?q={{ code_to_country[readup_countries[2]] }}" target="_blank">{{ code_to_country[readup_countries[2]] }}</a>!
			{% else %}
			试试阅读更多有关<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[0]]][lang] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[0]]][lang] }}</a>、<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[1]]][lang] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[1]]][lang] }}</a>和<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[2]]][lang] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[2]]][lang] }}</a>的新闻。
			{% endif %}
			{% else %}
			{% if lang == "en" %}
			Try reading up on what's going on in <a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[0]]]["chn"] }}" target="_blank">{{ code_to_country[readup_countries[0]] }}</a>, <a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[1]]]["chn"] }}" target="_blank">{{ code_to_country[readup_countries[1]] }}</a>, and <a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[2]]]["chn"] }}" target="_blank">{{ code_to_country[readup_countries[2]] }}</a>!
			{% else %}
			试试阅读更多有关<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[0]]]["chn"] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[0]]][lang] }}</a>、<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[1]]]["chn"] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[1]]][lang] }}</a>和<a href="http://news.baidu.com/ns?word={{ strings_d[code_to_country[readup_countries[2]]]["chn"] }}" target="_blank">{{ strings_d[code_to_country[readup_countries[2]]][lang] }}</a>的新闻。
			{% endif %}
			{% endif %}
		</div>
		<hr>
	</div>
	<div id="sharing_box">
		{% if lang == "en" %}
		<div id="thanks_en">
		Thanks for taking the quiz! If you enjoyed it, help us out by sharing it with your friends and followers!
		{% else %}
		<div id="thanks_chn">
		谢谢！如果您喜欢本次调研，欢迎将它分享给您的朋友！这样也会帮助我们进行研究。
		{% endif %}
		</div>
		{% if not in_china %}
		<div ng-controller="ResultsCtrl">
		<div class="sharing_buttons" {% if lang == "chn" %} id="sharing_buttons_chn" {% endif %}>
		
			<input ng-click="shareOnFacebook()" id="fb_share_button" class="btn btn-default" style="outline-color: #9245AB;" type="submit" value="{{ strings_d["Share on Facebook"][lang] }}"></input>
			<input ng-click="shareOnTwitter()" id="twitter_share_button" class="btn btn-default" style="outline-color: #9245AB;" type="submit" value="{{ strings_d["Share on Twitter"][lang] }}"></input>
		<!--<div class="fb-share-button" data-href="http://worldnewsquiz-dev.mediameter.org/?pc={{ pct_correct }}" data-layout="button"></div>
		<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://worldnewsquiz-dev.mediameter.org" data-text="I scored {{ pct_correct}}%! Test your World News knowledge with this quiz developed at MIT!" data-count="none" data-hashtags="WorldNewsQuiz" {% if lang == "chn" %} data-lang="zh-cn" {% endif %}>Tweet</a>
		</div>-->
		{% else %}
		<div id="sharing_well" class="well well-sm">
		<a href="https://gboqt.herokuapp.com">worldnewsquiz.mediameter.org</a>
		</div>
		</div>
		</div>
		{% endif %}
		<!--<div class="google-share-button g-plus" data-action="share" data-annotation="none" data-href="https://google.com"></div>-->
<!--<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>-->
	</div>
	<!--<div id="sharing_box">
		<div id="thanks">
			Thanks for taking the quiz!
			<div id="percent2">
			77%
			</div>
			<div id="result2">
			Not bad! You got <text>17</text> of the 22 questions right!
			</div>
		</div>
		<div id="percentile2">
			<div id="percentile_statement2">
			How you stack up against other quiz takers!
			</div>
		</div>
	</div>-->
	</div>
	<!--<h2 id='world_news_quiz_title'>{{ strings_d["World News Quiz"][lang] }}</h2>
	<h3 id='error_title'>{{ pct_correct }}%!</h3>
	<div id='completion_explanation'>
		{{ "You got " + num_correct + " out of 22 correct!" }}
	<br>
	<hr>
	<div id="share">
		If you enjoyed the quiz, we'd appreciate it if you help us out by sharing it with your friends.
	</div>
	<br>
	<div id='contact_info'>
		{{ strings_d['If you have any questions about the study, please email Anu Kashyap at akashyap@mit.edu and Erhardt Graeff at erhardt@media.mit.edu. Additionally, if you feel you have been treated unfairly, or you have questions regarding your rights as a research subject, you may contact the Chairman of the Committee on the Use of Humans as Experimental Subjects, MIT, Room E25-143B, 77 Massachusetts Ave, Cambridge, MA 02139, Phone 1-617-253-6787.'][lang] }}
	</div>-->
	<!--<a href="https://www.facebook.com/sharer/sharer.php?u=localhost:5000" target="_blank">
  Share on Facebook
</a>-->
	<div hidden id="footer">
      {{ strings_d["Center for Civic Media @ MIT Media Lab, 2015."][lang] }}
      </div>
</body>

</html>